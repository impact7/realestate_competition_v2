{% set train_test = var('train_test') %}
{% set table_name = '01_01_' ~ train_test ~ '_dm_base' %}
{{ config(alias='03_02_' ~ train_test ~ '_dm_union_tag_temp') }}

with temp1 as (
SELECT
  id,
  max(case when unit_tag_id = 110101 then 1 else 0 end) as unit_tag_110101,
  max(case when unit_tag_id = 110102 then 1 else 0 end) as unit_tag_110102,
  max(case when unit_tag_id = 110201 then 1 else 0 end) as unit_tag_110201,
  max(case when unit_tag_id = 110202 then 1 else 0 end) as unit_tag_110202,
  max(case when unit_tag_id = 110301 then 1 else 0 end) as unit_tag_110301,
  max(case when unit_tag_id = 110302 then 1 else 0 end) as unit_tag_110302,
  max(case when unit_tag_id = 110401 then 1 else 0 end) as unit_tag_110401,
  max(case when unit_tag_id = 110402 then 1 else 0 end) as unit_tag_110402,
  max(case when unit_tag_id = 110501 then 1 else 0 end) as unit_tag_110501,
  max(case when unit_tag_id = 110502 then 1 else 0 end) as unit_tag_110502,
  max(case when unit_tag_id = 110503 then 1 else 0 end) as unit_tag_110503,
  max(case when unit_tag_id = 110601 then 1 else 0 end) as unit_tag_110601,
  max(case when unit_tag_id = 110602 then 1 else 0 end) as unit_tag_110602,
  max(case when unit_tag_id = 110603 then 1 else 0 end) as unit_tag_110603,
  max(case when unit_tag_id = 110701 then 1 else 0 end) as unit_tag_110701,
  max(case when unit_tag_id = 110702 then 1 else 0 end) as unit_tag_110702,
  max(case when unit_tag_id = 110801 then 1 else 0 end) as unit_tag_110801,
  max(case when unit_tag_id = 110802 then 1 else 0 end) as unit_tag_110802,
  max(case when unit_tag_id = 110901 then 1 else 0 end) as unit_tag_110901,
  max(case when unit_tag_id = 110902 then 1 else 0 end) as unit_tag_110902,
  max(case when unit_tag_id = 110903 then 1 else 0 end) as unit_tag_110903,
  max(case when unit_tag_id = 111001 then 1 else 0 end) as unit_tag_111001,
  max(case when unit_tag_id = 111002 then 1 else 0 end) as unit_tag_111002,
  max(case when unit_tag_id = 113101 then 1 else 0 end) as unit_tag_113101,
  max(case when unit_tag_id = 113201 then 1 else 0 end) as unit_tag_113201,
  max(case when unit_tag_id = 113301 then 1 else 0 end) as unit_tag_113301,
  max(case when unit_tag_id = 113302 then 1 else 0 end) as unit_tag_113302,
  max(case when unit_tag_id = 113303 then 1 else 0 end) as unit_tag_113303,
  max(case when unit_tag_id = 113401 then 1 else 0 end) as unit_tag_113401,
  max(case when unit_tag_id = 113402 then 1 else 0 end) as unit_tag_113402,
  max(case when unit_tag_id = 113501 then 1 else 0 end) as unit_tag_113501,
  max(case when unit_tag_id = 113601 then 1 else 0 end) as unit_tag_113601,
  max(case when unit_tag_id = 113701 then 1 else 0 end) as unit_tag_113701,
  max(case when unit_tag_id = 120101 then 1 else 0 end) as unit_tag_120101,
  max(case when unit_tag_id = 120201 then 1 else 0 end) as unit_tag_120201,
  max(case when unit_tag_id = 120301 then 1 else 0 end) as unit_tag_120301,
  max(case when unit_tag_id = 120401 then 1 else 0 end) as unit_tag_120401,
  max(case when unit_tag_id = 120501 then 1 else 0 end) as unit_tag_120501,
  max(case when unit_tag_id = 120601 then 1 else 0 end) as unit_tag_120601,
  max(case when unit_tag_id = 120801 then 1 else 0 end) as unit_tag_120801,
  max(case when unit_tag_id = 120901 then 1 else 0 end) as unit_tag_120901,
  max(case when unit_tag_id = 121001 then 1 else 0 end) as unit_tag_121001,
  max(case when unit_tag_id = 121002 then 1 else 0 end) as unit_tag_121002,
  max(case when unit_tag_id = 121101 then 1 else 0 end) as unit_tag_121101,
  max(case when unit_tag_id = 123101 then 1 else 0 end) as unit_tag_123101,
  max(case when unit_tag_id = 123201 then 1 else 0 end) as unit_tag_123201,
  max(case when unit_tag_id = 123301 then 1 else 0 end) as unit_tag_123301,
  max(case when unit_tag_id = 123401 then 1 else 0 end) as unit_tag_123401,
  max(case when unit_tag_id = 123501 then 1 else 0 end) as unit_tag_123501,
  max(case when unit_tag_id = 123601 then 1 else 0 end) as unit_tag_123601,
  max(case when unit_tag_id = 190101 then 1 else 0 end) as unit_tag_190101,
  max(case when unit_tag_id = 193101 then 1 else 0 end) as unit_tag_193101,
  max(case when unit_tag_id = 193201 then 1 else 0 end) as unit_tag_193201,
  max(case when unit_tag_id = 193301 then 1 else 0 end) as unit_tag_193301,
  max(case when unit_tag_id = 193401 then 1 else 0 end) as unit_tag_193401,
  max(case when unit_tag_id = 193501 then 1 else 0 end) as unit_tag_193501,
  max(case when unit_tag_id = 193601 then 1 else 0 end) as unit_tag_193601,
  max(case when unit_tag_id = 193701 then 1 else 0 end) as unit_tag_193701,
  max(case when unit_tag_id = 210101 then 1 else 0 end) as unit_tag_210101,
  max(case when unit_tag_id = 210102 then 1 else 0 end) as unit_tag_210102,
  max(case when unit_tag_id = 210199 then 1 else 0 end) as unit_tag_210199,
  max(case when unit_tag_id = 210201 then 1 else 0 end) as unit_tag_210201,
  max(case when unit_tag_id = 210202 then 1 else 0 end) as unit_tag_210202,
  max(case when unit_tag_id = 210299 then 1 else 0 end) as unit_tag_210299,
  max(case when unit_tag_id = 210301 then 1 else 0 end) as unit_tag_210301,
  max(case when unit_tag_id = 210302 then 1 else 0 end) as unit_tag_210302,
  max(case when unit_tag_id = 210303 then 1 else 0 end) as unit_tag_210303,
  max(case when unit_tag_id = 210399 then 1 else 0 end) as unit_tag_210399,
  max(case when unit_tag_id = 210401 then 1 else 0 end) as unit_tag_210401,
  max(case when unit_tag_id = 213101 then 1 else 0 end) as unit_tag_213101,
  max(case when unit_tag_id = 213201 then 1 else 0 end) as unit_tag_213201,
  max(case when unit_tag_id = 213301 then 1 else 0 end) as unit_tag_213301,
  max(case when unit_tag_id = 220101 then 1 else 0 end) as unit_tag_220101,
  max(case when unit_tag_id = 220102 then 1 else 0 end) as unit_tag_220102,
  max(case when unit_tag_id = 220103 then 1 else 0 end) as unit_tag_220103,
  max(case when unit_tag_id = 220201 then 1 else 0 end) as unit_tag_220201,
  max(case when unit_tag_id = 220202 then 1 else 0 end) as unit_tag_220202,
  max(case when unit_tag_id = 220203 then 1 else 0 end) as unit_tag_220203,
  max(case when unit_tag_id = 220301 then 1 else 0 end) as unit_tag_220301,
  max(case when unit_tag_id = 220401 then 1 else 0 end) as unit_tag_220401,
  max(case when unit_tag_id = 220501 then 1 else 0 end) as unit_tag_220501,
  max(case when unit_tag_id = 220601 then 1 else 0 end) as unit_tag_220601,
  max(case when unit_tag_id = 220701 then 1 else 0 end) as unit_tag_220701,
  max(case when unit_tag_id = 220801 then 1 else 0 end) as unit_tag_220801,
  max(case when unit_tag_id = 220901 then 1 else 0 end) as unit_tag_220901,
  max(case when unit_tag_id = 220902 then 1 else 0 end) as unit_tag_220902,
  max(case when unit_tag_id = 223101 then 1 else 0 end) as unit_tag_223101,
  max(case when unit_tag_id = 223201 then 1 else 0 end) as unit_tag_223201,
  max(case when unit_tag_id = 223301 then 1 else 0 end) as unit_tag_223301,
  max(case when unit_tag_id = 223401 then 1 else 0 end) as unit_tag_223401,
  max(case when unit_tag_id = 223501 then 1 else 0 end) as unit_tag_223501,
  max(case when unit_tag_id = 223601 then 1 else 0 end) as unit_tag_223601,
  max(case when unit_tag_id = 230101 then 1 else 0 end) as unit_tag_230101,
  max(case when unit_tag_id = 230102 then 1 else 0 end) as unit_tag_230102,
  max(case when unit_tag_id = 230103 then 1 else 0 end) as unit_tag_230103,
  max(case when unit_tag_id = 230201 then 1 else 0 end) as unit_tag_230201,
  max(case when unit_tag_id = 230202 then 1 else 0 end) as unit_tag_230202,
  max(case when unit_tag_id = 230203 then 1 else 0 end) as unit_tag_230203,
  max(case when unit_tag_id = 230204 then 1 else 0 end) as unit_tag_230204,
  max(case when unit_tag_id = 230301 then 1 else 0 end) as unit_tag_230301,
  max(case when unit_tag_id = 230302 then 1 else 0 end) as unit_tag_230302,
  max(case when unit_tag_id = 230401 then 1 else 0 end) as unit_tag_230401,
  max(case when unit_tag_id = 230501 then 1 else 0 end) as unit_tag_230501,
  max(case when unit_tag_id = 230601 then 1 else 0 end) as unit_tag_230601,
  max(case when unit_tag_id = 230701 then 1 else 0 end) as unit_tag_230701,
  max(case when unit_tag_id = 230801 then 1 else 0 end) as unit_tag_230801,
  max(case when unit_tag_id = 230802 then 1 else 0 end) as unit_tag_230802,
  max(case when unit_tag_id = 230901 then 1 else 0 end) as unit_tag_230901,
  max(case when unit_tag_id = 233101 then 1 else 0 end) as unit_tag_233101,
  max(case when unit_tag_id = 233201 then 1 else 0 end) as unit_tag_233201,
  max(case when unit_tag_id = 240101 then 1 else 0 end) as unit_tag_240101,
  max(case when unit_tag_id = 240102 then 1 else 0 end) as unit_tag_240102,
  max(case when unit_tag_id = 240103 then 1 else 0 end) as unit_tag_240103,
  max(case when unit_tag_id = 240104 then 1 else 0 end) as unit_tag_240104,
  max(case when unit_tag_id = 240201 then 1 else 0 end) as unit_tag_240201,
  max(case when unit_tag_id = 250101 then 1 else 0 end) as unit_tag_250101,
  max(case when unit_tag_id = 250201 then 1 else 0 end) as unit_tag_250201,
  max(case when unit_tag_id = 250301 then 1 else 0 end) as unit_tag_250301,
  max(case when unit_tag_id = 253101 then 1 else 0 end) as unit_tag_253101,
  max(case when unit_tag_id = 253201 then 1 else 0 end) as unit_tag_253201,
  max(case when unit_tag_id = 253301 then 1 else 0 end) as unit_tag_253301,
  max(case when unit_tag_id = 253401 then 1 else 0 end) as unit_tag_253401,
  max(case when unit_tag_id = 253501 then 1 else 0 end) as unit_tag_253501,
  max(case when unit_tag_id = 253601 then 1 else 0 end) as unit_tag_253601,
  max(case when unit_tag_id = 253701 then 1 else 0 end) as unit_tag_253701,
  max(case when unit_tag_id = 260101 then 1 else 0 end) as unit_tag_260101,
  max(case when unit_tag_id = 260201 then 1 else 0 end) as unit_tag_260201,
  max(case when unit_tag_id = 260301 then 1 else 0 end) as unit_tag_260301,
  max(case when unit_tag_id = 260401 then 1 else 0 end) as unit_tag_260401,
  max(case when unit_tag_id = 260501 then 1 else 0 end) as unit_tag_260501,
  max(case when unit_tag_id = 260503 then 1 else 0 end) as unit_tag_260503,
  max(case when unit_tag_id = 260601 then 1 else 0 end) as unit_tag_260601,
  max(case when unit_tag_id = 263101 then 1 else 0 end) as unit_tag_263101,
  max(case when unit_tag_id = 263201 then 1 else 0 end) as unit_tag_263201,
  max(case when unit_tag_id = 263301 then 1 else 0 end) as unit_tag_263301,
  max(case when unit_tag_id = 270101 then 1 else 0 end) as unit_tag_270101,
  max(case when unit_tag_id = 273101 then 1 else 0 end) as unit_tag_273101,
  max(case when unit_tag_id = 273201 then 1 else 0 end) as unit_tag_273201,
  max(case when unit_tag_id = 273202 then 1 else 0 end) as unit_tag_273202,
  max(case when unit_tag_id = 273203 then 1 else 0 end) as unit_tag_273203,
  max(case when unit_tag_id = 273204 then 1 else 0 end) as unit_tag_273204,
  max(case when unit_tag_id = 283101 then 1 else 0 end) as unit_tag_283101,
  max(case when unit_tag_id = 283201 then 1 else 0 end) as unit_tag_283201,
  max(case when unit_tag_id = 283301 then 1 else 0 end) as unit_tag_283301,
  max(case when unit_tag_id = 283401 then 1 else 0 end) as unit_tag_283401,
  max(case when unit_tag_id = 290101 then 1 else 0 end) as unit_tag_290101,
  max(case when unit_tag_id = 290201 then 1 else 0 end) as unit_tag_290201,
  max(case when unit_tag_id = 290301 then 1 else 0 end) as unit_tag_290301,
  max(case when unit_tag_id = 290401 then 1 else 0 end) as unit_tag_290401,
  max(case when unit_tag_id = 290501 then 1 else 0 end) as unit_tag_290501,
  max(case when unit_tag_id = 290601 then 1 else 0 end) as unit_tag_290601,
  max(case when unit_tag_id = 290701 then 1 else 0 end) as unit_tag_290701,
  max(case when unit_tag_id = 290801 then 1 else 0 end) as unit_tag_290801,
  max(case when unit_tag_id = 290901 then 1 else 0 end) as unit_tag_290901,
  max(case when unit_tag_id = 290902 then 1 else 0 end) as unit_tag_290902,
  max(case when unit_tag_id = 293101 then 1 else 0 end) as unit_tag_293101,
  max(case when unit_tag_id = 293201 then 1 else 0 end) as unit_tag_293201,
  max(case when unit_tag_id = 293301 then 1 else 0 end) as unit_tag_293301,
  max(case when unit_tag_id = 293401 then 1 else 0 end) as unit_tag_293401,
  max(case when unit_tag_id = 293501 then 1 else 0 end) as unit_tag_293501,
  max(case when unit_tag_id = 293601 then 1 else 0 end) as unit_tag_293601,
  max(case when unit_tag_id = 293701 then 1 else 0 end) as unit_tag_293701,
  max(case when unit_tag_id = 293801 then 1 else 0 end) as unit_tag_293801,
  max(case when unit_tag_id = 294001 then 1 else 0 end) as unit_tag_294001,
  max(case when unit_tag_id = 294101 then 1 else 0 end) as unit_tag_294101,
  max(case when unit_tag_id = 294201 then 1 else 0 end) as unit_tag_294201,
  max(case when unit_tag_id = 294301 then 1 else 0 end) as unit_tag_294301,
  max(case when unit_tag_id = 310101 then 1 else 0 end) as unit_tag_310101,
  max(case when unit_tag_id = 310201 then 1 else 0 end) as unit_tag_310201,
  max(case when unit_tag_id = 310301 then 1 else 0 end) as unit_tag_310301,
  max(case when unit_tag_id = 310401 then 1 else 0 end) as unit_tag_310401,
  max(case when unit_tag_id = 310501 then 1 else 0 end) as unit_tag_310501,
  max(case when unit_tag_id = 313101 then 1 else 0 end) as unit_tag_313101,
  max(case when unit_tag_id = 313201 then 1 else 0 end) as unit_tag_313201,
  max(case when unit_tag_id = 313301 then 1 else 0 end) as unit_tag_313301,
  max(case when unit_tag_id = 320101 then 1 else 0 end) as unit_tag_320101,
  max(case when unit_tag_id = 320201 then 1 else 0 end) as unit_tag_320201,
  max(case when unit_tag_id = 320301 then 1 else 0 end) as unit_tag_320301,
  max(case when unit_tag_id = 320401 then 1 else 0 end) as unit_tag_320401,
  max(case when unit_tag_id = 320501 then 1 else 0 end) as unit_tag_320501,
  max(case when unit_tag_id = 320601 then 1 else 0 end) as unit_tag_320601,
  max(case when unit_tag_id = 320701 then 1 else 0 end) as unit_tag_320701,
  max(case when unit_tag_id = 320801 then 1 else 0 end) as unit_tag_320801,
  max(case when unit_tag_id = 320901 then 1 else 0 end) as unit_tag_320901,
  max(case when unit_tag_id = 321001 then 1 else 0 end) as unit_tag_321001,
  max(case when unit_tag_id = 321101 then 1 else 0 end) as unit_tag_321101,
  max(case when unit_tag_id = 323101 then 1 else 0 end) as unit_tag_323101,
  max(case when unit_tag_id = 323201 then 1 else 0 end) as unit_tag_323201,
  max(case when unit_tag_id = 330101 then 1 else 0 end) as unit_tag_330101,
  max(case when unit_tag_id = 330201 then 1 else 0 end) as unit_tag_330201,
  max(case when unit_tag_id = 330202 then 1 else 0 end) as unit_tag_330202,
  max(case when unit_tag_id = 330203 then 1 else 0 end) as unit_tag_330203,
  max(case when unit_tag_id = 330301 then 1 else 0 end) as unit_tag_330301,
  max(case when unit_tag_id = 330401 then 1 else 0 end) as unit_tag_330401,
  max(case when unit_tag_id = 330501 then 1 else 0 end) as unit_tag_330501,
  max(case when unit_tag_id = 330601 then 1 else 0 end) as unit_tag_330601,
  max(case when unit_tag_id = 330701 then 1 else 0 end) as unit_tag_330701,
  max(case when unit_tag_id = 330801 then 1 else 0 end) as unit_tag_330801,
  max(case when unit_tag_id = 330901 then 1 else 0 end) as unit_tag_330901,
  max(case when unit_tag_id = 331001 then 1 else 0 end) as unit_tag_331001,
  max(case when unit_tag_id = 333101 then 1 else 0 end) as unit_tag_333101,
  max(case when unit_tag_id = 333201 then 1 else 0 end) as unit_tag_333201,
  max(case when unit_tag_id = 333301 then 1 else 0 end) as unit_tag_333301,
  max(case when unit_tag_id = 333401 then 1 else 0 end) as unit_tag_333401,
  max(case when unit_tag_id = 333402 then 1 else 0 end) as unit_tag_333402,
  max(case when unit_tag_id = 333501 then 1 else 0 end) as unit_tag_333501,
  max(case when unit_tag_id = 333601 then 1 else 0 end) as unit_tag_333601,
  max(case when unit_tag_id = 333701 then 1 else 0 end) as unit_tag_333701,
  max(case when unit_tag_id = 333801 then 1 else 0 end) as unit_tag_333801,
  max(case when unit_tag_id = 333901 then 1 else 0 end) as unit_tag_333901,
  max(case when unit_tag_id = 334001 then 1 else 0 end) as unit_tag_334001,
  max(case when unit_tag_id = 334101 then 1 else 0 end) as unit_tag_334101,
  max(case when unit_tag_id = 334201 then 1 else 0 end) as unit_tag_334201,
  max(case when unit_tag_id = 334301 then 1 else 0 end) as unit_tag_334301,
  max(case when unit_tag_id = 334401 then 1 else 0 end) as unit_tag_334401,
  max(case when unit_tag_id = 334501 then 1 else 0 end) as unit_tag_334501,
  max(case when unit_tag_id = 334601 then 1 else 0 end) as unit_tag_334601,
  max(case when unit_tag_id = 334701 then 1 else 0 end) as unit_tag_334701,
  max(case when unit_tag_id = 334801 then 1 else 0 end) as unit_tag_334801,
  max(case when unit_tag_id = 334901 then 1 else 0 end) as unit_tag_334901,
  max(case when unit_tag_id = 335001 then 1 else 0 end) as unit_tag_335001,
  max(case when unit_tag_id = 335101 then 1 else 0 end) as unit_tag_335101,
  max(case when unit_tag_id = 335201 then 1 else 0 end) as unit_tag_335201,
  max(case when unit_tag_id = 335301 then 1 else 0 end) as unit_tag_335301,
  max(case when unit_tag_id = 335401 then 1 else 0 end) as unit_tag_335401,
  max(case when unit_tag_id = 335501 then 1 else 0 end) as unit_tag_335501,
  max(case when unit_tag_id = 335601 then 1 else 0 end) as unit_tag_335601,
  max(case when unit_tag_id = 335701 then 1 else 0 end) as unit_tag_335701,
  max(case when unit_tag_id = 335901 then 1 else 0 end) as unit_tag_335901,
  max(case when unit_tag_id = 335902 then 1 else 0 end) as unit_tag_335902,
  max(case when unit_tag_id = 336001 then 1 else 0 end) as unit_tag_336001,
  max(case when unit_tag_id = 336101 then 1 else 0 end) as unit_tag_336101,
  max(case when unit_tag_id = 336201 then 1 else 0 end) as unit_tag_336201,
  max(case when unit_tag_id = 336301 then 1 else 0 end) as unit_tag_336301,
  max(case when unit_tag_id = 336401 then 1 else 0 end) as unit_tag_336401,
  max(case when unit_tag_id = 336501 then 1 else 0 end) as unit_tag_336501,
  max(case when unit_tag_id = 340101 then 1 else 0 end) as unit_tag_340101,
  max(case when unit_tag_id = 340102 then 1 else 0 end) as unit_tag_340102,
  max(case when unit_tag_id = 340103 then 1 else 0 end) as unit_tag_340103,
  max(case when unit_tag_id = 340201 then 1 else 0 end) as unit_tag_340201,
  max(case when unit_tag_id = 340301 then 1 else 0 end) as unit_tag_340301,
  max(case when unit_tag_id = 340401 then 1 else 0 end) as unit_tag_340401,
  max(case when unit_tag_id = 340501 then 1 else 0 end) as unit_tag_340501,
  max(case when unit_tag_id = 343101 then 1 else 0 end) as unit_tag_343101,
  max(case when unit_tag_id = 343201 then 1 else 0 end) as unit_tag_343201,
  max(case when unit_tag_id = 343301 then 1 else 0 end) as unit_tag_343301,
  max(case when unit_tag_id = 350101 then 1 else 0 end) as unit_tag_350101,
  max(case when unit_tag_id = 350102 then 1 else 0 end) as unit_tag_350102,
  max(case when unit_tag_id = 350201 then 1 else 0 end) as unit_tag_350201,
  max(case when unit_tag_id = 350301 then 1 else 0 end) as unit_tag_350301,
  max(case when unit_tag_id = 393101 then 1 else 0 end) as unit_tag_393101,
  max(case when unit_tag_id = 393201 then 1 else 0 end) as unit_tag_393201,
  max(case when unit_tag_id = 393301 then 1 else 0 end) as unit_tag_393301,
  max(case when unit_tag_id = 410101 then 1 else 0 end) as unit_tag_410101,
  max(case when unit_tag_id = 410102 then 1 else 0 end) as unit_tag_410102,
  max(case when unit_tag_id = 410103 then 1 else 0 end) as unit_tag_410103,
  max(case when unit_tag_id = 410104 then 1 else 0 end) as unit_tag_410104,
  max(case when unit_tag_id = 410105 then 1 else 0 end) as unit_tag_410105,
  max(case when unit_tag_id = 410106 then 1 else 0 end) as unit_tag_410106,
  max(case when unit_tag_id = 410201 then 1 else 0 end) as unit_tag_410201,
  max(case when unit_tag_id = 410202 then 1 else 0 end) as unit_tag_410202,
  max(case when unit_tag_id = 410203 then 1 else 0 end) as unit_tag_410203,
  max(case when unit_tag_id = 410204 then 1 else 0 end) as unit_tag_410204,
  max(case when unit_tag_id = 410205 then 1 else 0 end) as unit_tag_410205,
  max(case when unit_tag_id = 410206 then 1 else 0 end) as unit_tag_410206,
  max(case when unit_tag_id = 413101 then 1 else 0 end) as unit_tag_413101,
  max(case when unit_tag_id = 420101 then 1 else 0 end) as unit_tag_420101,
  max(case when unit_tag_id = 420102 then 1 else 0 end) as unit_tag_420102,
  max(case when unit_tag_id = 420103 then 1 else 0 end) as unit_tag_420103,
  max(case when unit_tag_id = 420104 then 1 else 0 end) as unit_tag_420104,
  max(case when unit_tag_id = 420105 then 1 else 0 end) as unit_tag_420105,
  max(case when unit_tag_id = 420106 then 1 else 0 end) as unit_tag_420106,
  max(case when unit_tag_id = 423101 then 1 else 0 end) as unit_tag_423101,
  max(case when unit_tag_id = 423102 then 1 else 0 end) as unit_tag_423102,
  max(case when unit_tag_id = 423103 then 1 else 0 end) as unit_tag_423103,
  max(case when unit_tag_id = 423104 then 1 else 0 end) as unit_tag_423104,
  max(case when unit_tag_id = 423105 then 1 else 0 end) as unit_tag_423105,
  max(case when unit_tag_id = 423106 then 1 else 0 end) as unit_tag_423106,
  max(case when unit_tag_id = 423201 then 1 else 0 end) as unit_tag_423201,
  max(case when unit_tag_id = 423301 then 1 else 0 end) as unit_tag_423301,
  max(case when unit_tag_id = 423401 then 1 else 0 end) as unit_tag_423401,
  max(case when unit_tag_id = 423501 then 1 else 0 end) as unit_tag_423501,
  max(case when unit_tag_id = 433101 then 1 else 0 end) as unit_tag_433101,
  max(case when unit_tag_id = 433102 then 1 else 0 end) as unit_tag_433102,
  max(case when unit_tag_id = 433201 then 1 else 0 end) as unit_tag_433201,
  max(case when unit_tag_id = 433301 then 1 else 0 end) as unit_tag_433301,
  max(case when unit_tag_id = 513701 then 1 else 0 end) as unit_tag_513701,
  max(case when unit_tag_id = 513801 then 1 else 0 end) as unit_tag_513801,
  max(case when unit_tag_id = 513901 then 1 else 0 end) as unit_tag_513901,
  max(case when unit_tag_id = 513902 then 1 else 0 end) as unit_tag_513902,
  max(case when unit_tag_id = 513903 then 1 else 0 end) as unit_tag_513903,
  max(case when unit_tag_id = 514001 then 1 else 0 end) as unit_tag_514001,
  max(case when unit_tag_id = 514002 then 1 else 0 end) as unit_tag_514002,
  max(case when unit_tag_id = 514101 then 1 else 0 end) as unit_tag_514101,
  max(case when unit_tag_id = 514102 then 1 else 0 end) as unit_tag_514102,
  max(case when unit_tag_id = 514103 then 1 else 0 end) as unit_tag_514103,
  max(case when unit_tag_id = 514201 then 1 else 0 end) as unit_tag_514201,
  max(case when unit_tag_id = 514301 then 1 else 0 end) as unit_tag_514301,
  max(case when unit_tag_id = 514401 then 1 else 0 end) as unit_tag_514401,
  max(case when unit_tag_id = 514501 then 1 else 0 end) as unit_tag_514501,
  max(case when unit_tag_id = 514601 then 1 else 0 end) as unit_tag_514601
from
    {{ ref('02_13_dm_unit_tag') }}
group by
  id
)
select
    t1.id,
    unit_tag_110101,
    unit_tag_110102,
    unit_tag_110201,
    unit_tag_110202,
    unit_tag_110301,
    unit_tag_110302,
    unit_tag_110401,
    unit_tag_110402,
    unit_tag_110501,
    unit_tag_110502,
    unit_tag_110503,
    unit_tag_110601,
    unit_tag_110602,
    unit_tag_110603,
    unit_tag_110701,
    unit_tag_110702,
    unit_tag_110801,
    unit_tag_110802,
    unit_tag_110901,
    unit_tag_110902,
    unit_tag_110903,
    unit_tag_111001,
    unit_tag_111002,
    unit_tag_113101,
    unit_tag_113201,
    unit_tag_113301,
    unit_tag_113302,
    unit_tag_113303,
    unit_tag_113401,
    unit_tag_113402,
    unit_tag_113501,
    unit_tag_113601,
    unit_tag_113701,
    unit_tag_120101,
    unit_tag_120201,
    unit_tag_120301,
    unit_tag_120401,
    unit_tag_120501,
    unit_tag_120601,
    unit_tag_120801,
    unit_tag_120901,
    unit_tag_121001,
    unit_tag_121002,
    unit_tag_121101,
    unit_tag_123101,
    unit_tag_123201,
    unit_tag_123301,
    unit_tag_123401,
    unit_tag_123501,
    unit_tag_123601,
    unit_tag_190101,
    unit_tag_193101,
    unit_tag_193201,
    unit_tag_193301,
    unit_tag_193401,
    unit_tag_193501,
    unit_tag_193601,
    unit_tag_193701,
    unit_tag_210101,
    unit_tag_210102,
    unit_tag_210199,
    unit_tag_210201,
    unit_tag_210202,
    unit_tag_210299,
    unit_tag_210301,
    unit_tag_210302,
    unit_tag_210303,
    unit_tag_210399,
    unit_tag_210401,
    unit_tag_213101,
    unit_tag_213201,
    unit_tag_213301,
    unit_tag_220101,
    unit_tag_220102,
    unit_tag_220103,
    unit_tag_220201,
    unit_tag_220202,
    unit_tag_220203,
    unit_tag_220301,
    unit_tag_220401,
    unit_tag_220501,
    unit_tag_220601,
    unit_tag_220701,
    unit_tag_220801,
    unit_tag_220901,
    unit_tag_220902,
    unit_tag_223101,
    unit_tag_223201,
    unit_tag_223301,
    unit_tag_223401,
    unit_tag_223501,
    unit_tag_223601,
    unit_tag_230101,
    unit_tag_230102,
    unit_tag_230103,
    unit_tag_230201,
    unit_tag_230202,
    unit_tag_230203,
    unit_tag_230204,
    unit_tag_230301,
    unit_tag_230302,
    unit_tag_230401,
    unit_tag_230501,
    unit_tag_230601,
    unit_tag_230701,
    unit_tag_230801,
    unit_tag_230802,
    unit_tag_230901,
    unit_tag_233101,
    unit_tag_233201,
    unit_tag_240101,
    unit_tag_240102,
    unit_tag_240103,
    unit_tag_240104,
    unit_tag_240201,
    unit_tag_250101,
    unit_tag_250201,
    unit_tag_250301,
    unit_tag_253101,
    unit_tag_253201,
    unit_tag_253301,
    unit_tag_253401,
    unit_tag_253501,
    unit_tag_253601,
    unit_tag_253701,
    unit_tag_260101,
    unit_tag_260201,
    unit_tag_260301,
    unit_tag_260401,
    unit_tag_260501,
    unit_tag_260503,
    unit_tag_260601,
    unit_tag_263101,
    unit_tag_263201,
    unit_tag_263301,
    unit_tag_270101,
    unit_tag_273101,
    unit_tag_273201,
    unit_tag_273202,
    unit_tag_273203,
    unit_tag_273204,
    unit_tag_283101,
    unit_tag_283201,
    unit_tag_283301,
    unit_tag_283401,
    unit_tag_290101,
    unit_tag_290201,
    unit_tag_290301,
    unit_tag_290401,
    unit_tag_290501,
    unit_tag_290601,
    unit_tag_290701,
    unit_tag_290801,
    unit_tag_290901,
    unit_tag_290902,
    unit_tag_293101,
    unit_tag_293201,
    unit_tag_293301,
    unit_tag_293401,
    unit_tag_293501,
    unit_tag_293601,
    unit_tag_293701,
    unit_tag_293801,
    unit_tag_294001,
    unit_tag_294101,
    unit_tag_294201,
    unit_tag_294301,
    unit_tag_310101,
    unit_tag_310201,
    unit_tag_310301,
    unit_tag_310401,
    unit_tag_310501,
    unit_tag_313101,
    unit_tag_313201,
    unit_tag_313301,
    unit_tag_320101,
    unit_tag_320201,
    unit_tag_320301,
    unit_tag_320401,
    unit_tag_320501,
    unit_tag_320601,
    unit_tag_320701,
    unit_tag_320801,
    unit_tag_320901,
    unit_tag_321001,
    unit_tag_321101,
    unit_tag_323101,
    unit_tag_323201,
    unit_tag_330101,
    unit_tag_330201,
    unit_tag_330202,
    unit_tag_330203,
    unit_tag_330301,
    unit_tag_330401,
    unit_tag_330501,
    unit_tag_330601,
    unit_tag_330701,
    unit_tag_330801,
    unit_tag_330901,
    unit_tag_331001,
    unit_tag_333101,
    unit_tag_333201,
    unit_tag_333301,
    unit_tag_333401,
    unit_tag_333402,
    unit_tag_333501,
    unit_tag_333601,
    unit_tag_333701,
    unit_tag_333801,
    unit_tag_333901,
    unit_tag_334001,
    unit_tag_334101,
    unit_tag_334201,
    unit_tag_334301,
    unit_tag_334401,
    unit_tag_334501,
    unit_tag_334601,
    unit_tag_334701,
    unit_tag_334801,
    unit_tag_334901,
    unit_tag_335001,
    unit_tag_335101,
    unit_tag_335201,
    unit_tag_335301,
    unit_tag_335401,
    unit_tag_335501,
    unit_tag_335601,
    unit_tag_335701,
    unit_tag_335901,
    unit_tag_335902,
    unit_tag_336001,
    unit_tag_336101,
    unit_tag_336201,
    unit_tag_336301,
    unit_tag_336401,
    unit_tag_336501,
    unit_tag_340101,
    unit_tag_340102,
    unit_tag_340103,
    unit_tag_340201,
    unit_tag_340301,
    unit_tag_340401,
    unit_tag_340501,
    unit_tag_343101,
    unit_tag_343201,
    unit_tag_343301,
    unit_tag_350101,
    unit_tag_350102,
    unit_tag_350201,
    unit_tag_350301,
    unit_tag_393101,
    unit_tag_393201,
    unit_tag_393301,
    unit_tag_410101,
    unit_tag_410102,
    unit_tag_410103,
    unit_tag_410104,
    unit_tag_410105,
    unit_tag_410106,
    unit_tag_410201,
    unit_tag_410202,
    unit_tag_410203,
    unit_tag_410204,
    unit_tag_410205,
    unit_tag_410206,
    unit_tag_413101,
    unit_tag_420101,
    unit_tag_420102,
    unit_tag_420103,
    unit_tag_420104,
    unit_tag_420105,
    unit_tag_420106,
    unit_tag_423101,
    unit_tag_423102,
    unit_tag_423103,
    unit_tag_423104,
    unit_tag_423105,
    unit_tag_423106,
    unit_tag_423201,
    unit_tag_423301,
    unit_tag_423401,
    unit_tag_423501,
    unit_tag_433101,
    unit_tag_433102,
    unit_tag_433201,
    unit_tag_433301,
    unit_tag_513701,
    unit_tag_513801,
    unit_tag_513901,
    unit_tag_513902,
    unit_tag_513903,
    unit_tag_514001,
    unit_tag_514002,
    unit_tag_514101,
    unit_tag_514102,
    unit_tag_514103,
    unit_tag_514201,
    unit_tag_514301,
    unit_tag_514401,
    unit_tag_514501,
    unit_tag_514601
from
    {{ ref(table_name) }} as t1
    left join
    temp1 as t2
    on
        t1.id = t2.id
