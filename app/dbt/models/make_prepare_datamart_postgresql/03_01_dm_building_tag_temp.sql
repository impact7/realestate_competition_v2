{% set train_test = var('train_test') %}
{% set table_name = '01_01_' ~ train_test ~ '_dm_base' %}
{{ config(alias='03_01_' ~ train_test ~ '_dm_building_tag_temp') }}

with temp1 as (
SELECT
    id,
    MAX(CASE WHEN building_tag_id = 210101 THEN 1 ELSE 0 END) AS building_tag_210101,
    MAX(CASE WHEN building_tag_id = 210102 THEN 1 ELSE 0 END) AS building_tag_210102,
    MAX(CASE WHEN building_tag_id = 210199 THEN 1 ELSE 0 END) AS building_tag_210199,
    MAX(CASE WHEN building_tag_id = 210201 THEN 1 ELSE 0 END) AS building_tag_210201,
    MAX(CASE WHEN building_tag_id = 210202 THEN 1 ELSE 0 END) AS building_tag_210202,
    MAX(CASE WHEN building_tag_id = 210299 THEN 1 ELSE 0 END) AS building_tag_210299,
    MAX(CASE WHEN building_tag_id = 210301 THEN 1 ELSE 0 END) AS building_tag_210301,
    MAX(CASE WHEN building_tag_id = 210302 THEN 1 ELSE 0 END) AS building_tag_210302,
    MAX(CASE WHEN building_tag_id = 210303 THEN 1 ELSE 0 END) AS building_tag_210303,
    MAX(CASE WHEN building_tag_id = 210399 THEN 1 ELSE 0 END) AS building_tag_210399,
    MAX(CASE WHEN building_tag_id = 210401 THEN 1 ELSE 0 END) AS building_tag_210401,
    MAX(CASE WHEN building_tag_id = 213101 THEN 1 ELSE 0 END) AS building_tag_213101,
    MAX(CASE WHEN building_tag_id = 213201 THEN 1 ELSE 0 END) AS building_tag_213201,
    MAX(CASE WHEN building_tag_id = 213301 THEN 1 ELSE 0 END) AS building_tag_213301,
    MAX(CASE WHEN building_tag_id = 294201 THEN 1 ELSE 0 END) AS building_tag_294201,
    MAX(CASE WHEN building_tag_id = 310101 THEN 1 ELSE 0 END) AS building_tag_310101,
    MAX(CASE WHEN building_tag_id = 310201 THEN 1 ELSE 0 END) AS building_tag_310201,
    MAX(CASE WHEN building_tag_id = 310301 THEN 1 ELSE 0 END) AS building_tag_310301,
    MAX(CASE WHEN building_tag_id = 310401 THEN 1 ELSE 0 END) AS building_tag_310401,
    MAX(CASE WHEN building_tag_id = 313101 THEN 1 ELSE 0 END) AS building_tag_313101,
    MAX(CASE WHEN building_tag_id = 320101 THEN 1 ELSE 0 END) AS building_tag_320101,
    MAX(CASE WHEN building_tag_id = 320201 THEN 1 ELSE 0 END) AS building_tag_320201,
    MAX(CASE WHEN building_tag_id = 320301 THEN 1 ELSE 0 END) AS building_tag_320301,
    MAX(CASE WHEN building_tag_id = 320401 THEN 1 ELSE 0 END) AS building_tag_320401,
    MAX(CASE WHEN building_tag_id = 320501 THEN 1 ELSE 0 END) AS building_tag_320501,
    MAX(CASE WHEN building_tag_id = 320701 THEN 1 ELSE 0 END) AS building_tag_320701,
    MAX(CASE WHEN building_tag_id = 320801 THEN 1 ELSE 0 END) AS building_tag_320801,
    MAX(CASE WHEN building_tag_id = 320901 THEN 1 ELSE 0 END) AS building_tag_320901,
    MAX(CASE WHEN building_tag_id = 321001 THEN 1 ELSE 0 END) AS building_tag_321001,
    MAX(CASE WHEN building_tag_id = 321101 THEN 1 ELSE 0 END) AS building_tag_321101,
    MAX(CASE WHEN building_tag_id = 323101 THEN 1 ELSE 0 END) AS building_tag_323101,
    MAX(CASE WHEN building_tag_id = 323201 THEN 1 ELSE 0 END) AS building_tag_323201,
    MAX(CASE WHEN building_tag_id = 330101 THEN 1 ELSE 0 END) AS building_tag_330101,
    MAX(CASE WHEN building_tag_id = 330201 THEN 1 ELSE 0 END) AS building_tag_330201,
    MAX(CASE WHEN building_tag_id = 330301 THEN 1 ELSE 0 END) AS building_tag_330301,
    MAX(CASE WHEN building_tag_id = 330401 THEN 1 ELSE 0 END) AS building_tag_330401,
    MAX(CASE WHEN building_tag_id = 330501 THEN 1 ELSE 0 END) AS building_tag_330501,
    MAX(CASE WHEN building_tag_id = 330601 THEN 1 ELSE 0 END) AS building_tag_330601,
    MAX(CASE WHEN building_tag_id = 333201 THEN 1 ELSE 0 END) AS building_tag_333201,
    MAX(CASE WHEN building_tag_id = 333301 THEN 1 ELSE 0 END) AS building_tag_333301,
    MAX(CASE WHEN building_tag_id = 333401 THEN 1 ELSE 0 END) AS building_tag_333401,
    MAX(CASE WHEN building_tag_id = 333402 THEN 1 ELSE 0 END) AS building_tag_333402,
    MAX(CASE WHEN building_tag_id = 333601 THEN 1 ELSE 0 END) AS building_tag_333601,
    MAX(CASE WHEN building_tag_id = 333801 THEN 1 ELSE 0 END) AS building_tag_333801,
    MAX(CASE WHEN building_tag_id = 334001 THEN 1 ELSE 0 END) AS building_tag_334001,
    MAX(CASE WHEN building_tag_id = 334101 THEN 1 ELSE 0 END) AS building_tag_334101,
    MAX(CASE WHEN building_tag_id = 334201 THEN 1 ELSE 0 END) AS building_tag_334201,
    MAX(CASE WHEN building_tag_id = 334301 THEN 1 ELSE 0 END) AS building_tag_334301,
    MAX(CASE WHEN building_tag_id = 334501 THEN 1 ELSE 0 END) AS building_tag_334501,
    MAX(CASE WHEN building_tag_id = 340301 THEN 1 ELSE 0 END) AS building_tag_340301,
    MAX(CASE WHEN building_tag_id = 343201 THEN 1 ELSE 0 END) AS building_tag_343201,
    MAX(CASE WHEN building_tag_id = 343301 THEN 1 ELSE 0 END) AS building_tag_343301,
    MAX(CASE WHEN building_tag_id = 393101 THEN 1 ELSE 0 END) AS building_tag_393101,
    MAX(CASE WHEN building_tag_id = 393201 THEN 1 ELSE 0 END) AS building_tag_393201,
    MAX(CASE WHEN building_tag_id = 393401 THEN 1 ELSE 0 END) AS building_tag_393401,
    MAX(CASE WHEN building_tag_id = 410101 THEN 1 ELSE 0 END) AS building_tag_410101,
    MAX(CASE WHEN building_tag_id = 410201 THEN 1 ELSE 0 END) AS building_tag_410201,
    MAX(CASE WHEN building_tag_id = 410203 THEN 1 ELSE 0 END) AS building_tag_410203,
    MAX(CASE WHEN building_tag_id = 420101 THEN 1 ELSE 0 END) AS building_tag_420101,
    MAX(CASE WHEN building_tag_id = 423103 THEN 1 ELSE 0 END) AS building_tag_423103,
    MAX(CASE WHEN building_tag_id = 423201 THEN 1 ELSE 0 END) AS building_tag_423201,
    MAX(CASE WHEN building_tag_id = 423301 THEN 1 ELSE 0 END) AS building_tag_423301,
    MAX(CASE WHEN building_tag_id = 423401 THEN 1 ELSE 0 END) AS building_tag_423401,
    MAX(CASE WHEN building_tag_id = 423501 THEN 1 ELSE 0 END) AS building_tag_423501,
    MAX(CASE WHEN building_tag_id = 433201 THEN 1 ELSE 0 END) AS building_tag_433201,
    MAX(CASE WHEN building_tag_id = 433301 THEN 1 ELSE 0 END) AS building_tag_433301,
    MAX(CASE WHEN building_tag_id = 220101 THEN 1 ELSE 0 END) AS building_tag_220101,
    MAX(CASE WHEN building_tag_id = 220102 THEN 1 ELSE 0 END) AS building_tag_220102,
    MAX(CASE WHEN building_tag_id = 220103 THEN 1 ELSE 0 END) AS building_tag_220103,
    MAX(CASE WHEN building_tag_id = 220201 THEN 1 ELSE 0 END) AS building_tag_220201,
    MAX(CASE WHEN building_tag_id = 220202 THEN 1 ELSE 0 END) AS building_tag_220202,
    MAX(CASE WHEN building_tag_id = 220203 THEN 1 ELSE 0 END) AS building_tag_220203,
    MAX(CASE WHEN building_tag_id = 220301 THEN 1 ELSE 0 END) AS building_tag_220301,
    MAX(CASE WHEN building_tag_id = 220401 THEN 1 ELSE 0 END) AS building_tag_220401,
    MAX(CASE WHEN building_tag_id = 220501 THEN 1 ELSE 0 END) AS building_tag_220501,
    MAX(CASE WHEN building_tag_id = 220601 THEN 1 ELSE 0 END) AS building_tag_220601,
    MAX(CASE WHEN building_tag_id = 220701 THEN 1 ELSE 0 END) AS building_tag_220701,
    MAX(CASE WHEN building_tag_id = 220801 THEN 1 ELSE 0 END) AS building_tag_220801,
    MAX(CASE WHEN building_tag_id = 220901 THEN 1 ELSE 0 END) AS building_tag_220901,
    MAX(CASE WHEN building_tag_id = 220902 THEN 1 ELSE 0 END) AS building_tag_220902,
    MAX(CASE WHEN building_tag_id = 223101 THEN 1 ELSE 0 END) AS building_tag_223101,
    MAX(CASE WHEN building_tag_id = 223201 THEN 1 ELSE 0 END) AS building_tag_223201,
    MAX(CASE WHEN building_tag_id = 223301 THEN 1 ELSE 0 END) AS building_tag_223301,
    MAX(CASE WHEN building_tag_id = 223401 THEN 1 ELSE 0 END) AS building_tag_223401,
    MAX(CASE WHEN building_tag_id = 223501 THEN 1 ELSE 0 END) AS building_tag_223501,
    MAX(CASE WHEN building_tag_id = 223601 THEN 1 ELSE 0 END) AS building_tag_223601,
    MAX(CASE WHEN building_tag_id = 230101 THEN 1 ELSE 0 END) AS building_tag_230101,
    MAX(CASE WHEN building_tag_id = 230102 THEN 1 ELSE 0 END) AS building_tag_230102,
    MAX(CASE WHEN building_tag_id = 230103 THEN 1 ELSE 0 END) AS building_tag_230103,
    MAX(CASE WHEN building_tag_id = 230201 THEN 1 ELSE 0 END) AS building_tag_230201,
    MAX(CASE WHEN building_tag_id = 230202 THEN 1 ELSE 0 END) AS building_tag_230202,
    MAX(CASE WHEN building_tag_id = 230203 THEN 1 ELSE 0 END) AS building_tag_230203,
    MAX(CASE WHEN building_tag_id = 230204 THEN 1 ELSE 0 END) AS building_tag_230204,
    MAX(CASE WHEN building_tag_id = 230302 THEN 1 ELSE 0 END) AS building_tag_230302,
    MAX(CASE WHEN building_tag_id = 230401 THEN 1 ELSE 0 END) AS building_tag_230401,
    MAX(CASE WHEN building_tag_id = 230501 THEN 1 ELSE 0 END) AS building_tag_230501,
    MAX(CASE WHEN building_tag_id = 230601 THEN 1 ELSE 0 END) AS building_tag_230601,
    MAX(CASE WHEN building_tag_id = 230701 THEN 1 ELSE 0 END) AS building_tag_230701,
    MAX(CASE WHEN building_tag_id = 230801 THEN 1 ELSE 0 END) AS building_tag_230801,
    MAX(CASE WHEN building_tag_id = 230802 THEN 1 ELSE 0 END) AS building_tag_230802,
    MAX(CASE WHEN building_tag_id = 230901 THEN 1 ELSE 0 END) AS building_tag_230901,
    MAX(CASE WHEN building_tag_id = 233101 THEN 1 ELSE 0 END) AS building_tag_233101,
    MAX(CASE WHEN building_tag_id = 233201 THEN 1 ELSE 0 END) AS building_tag_233201,
    MAX(CASE WHEN building_tag_id = 240101 THEN 1 ELSE 0 END) AS building_tag_240101,
    MAX(CASE WHEN building_tag_id = 240102 THEN 1 ELSE 0 END) AS building_tag_240102,
    MAX(CASE WHEN building_tag_id = 240103 THEN 1 ELSE 0 END) AS building_tag_240103,
    MAX(CASE WHEN building_tag_id = 240104 THEN 1 ELSE 0 END) AS building_tag_240104,
    MAX(CASE WHEN building_tag_id = 240201 THEN 1 ELSE 0 END) AS building_tag_240201,
    MAX(CASE WHEN building_tag_id = 250101 THEN 1 ELSE 0 END) AS building_tag_250101,
    MAX(CASE WHEN building_tag_id = 250201 THEN 1 ELSE 0 END) AS building_tag_250201,
    MAX(CASE WHEN building_tag_id = 250301 THEN 1 ELSE 0 END) AS building_tag_250301,
    MAX(CASE WHEN building_tag_id = 253101 THEN 1 ELSE 0 END) AS building_tag_253101,
    MAX(CASE WHEN building_tag_id = 253201 THEN 1 ELSE 0 END) AS building_tag_253201,
    MAX(CASE WHEN building_tag_id = 253301 THEN 1 ELSE 0 END) AS building_tag_253301,
    MAX(CASE WHEN building_tag_id = 253401 THEN 1 ELSE 0 END) AS building_tag_253401,
    MAX(CASE WHEN building_tag_id = 253501 THEN 1 ELSE 0 END) AS building_tag_253501,
    MAX(CASE WHEN building_tag_id = 253601 THEN 1 ELSE 0 END) AS building_tag_253601,
    MAX(CASE WHEN building_tag_id = 253701 THEN 1 ELSE 0 END) AS building_tag_253701,
    MAX(CASE WHEN building_tag_id = 260101 THEN 1 ELSE 0 END) AS building_tag_260101,
    MAX(CASE WHEN building_tag_id = 260201 THEN 1 ELSE 0 END) AS building_tag_260201,
    MAX(CASE WHEN building_tag_id = 260301 THEN 1 ELSE 0 END) AS building_tag_260301,
    MAX(CASE WHEN building_tag_id = 260401 THEN 1 ELSE 0 END) AS building_tag_260401,
    MAX(CASE WHEN building_tag_id = 260501 THEN 1 ELSE 0 END) AS building_tag_260501,
    MAX(CASE WHEN building_tag_id = 260502 THEN 1 ELSE 0 END) AS building_tag_260502,
    MAX(CASE WHEN building_tag_id = 260503 THEN 1 ELSE 0 END) AS building_tag_260503,
    MAX(CASE WHEN building_tag_id = 260601 THEN 1 ELSE 0 END) AS building_tag_260601,
    MAX(CASE WHEN building_tag_id = 263101 THEN 1 ELSE 0 END) AS building_tag_263101,
    MAX(CASE WHEN building_tag_id = 263201 THEN 1 ELSE 0 END) AS building_tag_263201,
    MAX(CASE WHEN building_tag_id = 263301 THEN 1 ELSE 0 END) AS building_tag_263301,
    MAX(CASE WHEN building_tag_id = 270101 THEN 1 ELSE 0 END) AS building_tag_270101,
    MAX(CASE WHEN building_tag_id = 273101 THEN 1 ELSE 0 END) AS building_tag_273101,
    MAX(CASE WHEN building_tag_id = 283101 THEN 1 ELSE 0 END) AS building_tag_283101,
    MAX(CASE WHEN building_tag_id = 283201 THEN 1 ELSE 0 END) AS building_tag_283201,
    MAX(CASE WHEN building_tag_id = 283301 THEN 1 ELSE 0 END) AS building_tag_283301,
    MAX(CASE WHEN building_tag_id = 283401 THEN 1 ELSE 0 END) AS building_tag_283401,
    MAX(CASE WHEN building_tag_id = 290101 THEN 1 ELSE 0 END) AS building_tag_290101,
    MAX(CASE WHEN building_tag_id = 290201 THEN 1 ELSE 0 END) AS building_tag_290201,
    MAX(CASE WHEN building_tag_id = 290301 THEN 1 ELSE 0 END) AS building_tag_290301,
    MAX(CASE WHEN building_tag_id = 290401 THEN 1 ELSE 0 END) AS building_tag_290401,
    MAX(CASE WHEN building_tag_id = 290501 THEN 1 ELSE 0 END) AS building_tag_290501,
    MAX(CASE WHEN building_tag_id = 290601 THEN 1 ELSE 0 END) AS building_tag_290601,
    MAX(CASE WHEN building_tag_id = 290701 THEN 1 ELSE 0 END) AS building_tag_290701,
    MAX(CASE WHEN building_tag_id = 290801 THEN 1 ELSE 0 END) AS building_tag_290801,
    MAX(CASE WHEN building_tag_id = 290901 THEN 1 ELSE 0 END) AS building_tag_290901,
    MAX(CASE WHEN building_tag_id = 290902 THEN 1 ELSE 0 END) AS building_tag_290902,
    MAX(CASE WHEN building_tag_id = 293101 THEN 1 ELSE 0 END) AS building_tag_293101,
    MAX(CASE WHEN building_tag_id = 293201 THEN 1 ELSE 0 END) AS building_tag_293201,
    MAX(CASE WHEN building_tag_id = 293301 THEN 1 ELSE 0 END) AS building_tag_293301,
    MAX(CASE WHEN building_tag_id = 293401 THEN 1 ELSE 0 END) AS building_tag_293401,
    MAX(CASE WHEN building_tag_id = 293501 THEN 1 ELSE 0 END) AS building_tag_293501,
    MAX(CASE WHEN building_tag_id = 293601 THEN 1 ELSE 0 END) AS building_tag_293601,
    MAX(CASE WHEN building_tag_id = 293701 THEN 1 ELSE 0 END) AS building_tag_293701,
    MAX(CASE WHEN building_tag_id = 293801 THEN 1 ELSE 0 END) AS building_tag_293801,
    MAX(CASE WHEN building_tag_id = 294001 THEN 1 ELSE 0 END) AS building_tag_294001,
    MAX(CASE WHEN building_tag_id = 294101 THEN 1 ELSE 0 END) AS building_tag_294101,
    MAX(CASE WHEN building_tag_id = 294301 THEN 1 ELSE 0 END) AS building_tag_294301,
    MAX(CASE WHEN building_tag_id = 310501 THEN 1 ELSE 0 END) AS building_tag_310501,
    MAX(CASE WHEN building_tag_id = 313301 THEN 1 ELSE 0 END) AS building_tag_313301,
    MAX(CASE WHEN building_tag_id = 331001 THEN 1 ELSE 0 END) AS building_tag_331001,
    MAX(CASE WHEN building_tag_id = 334401 THEN 1 ELSE 0 END) AS building_tag_334401,
    MAX(CASE WHEN building_tag_id = 340101 THEN 1 ELSE 0 END) AS building_tag_340101,
    MAX(CASE WHEN building_tag_id = 340102 THEN 1 ELSE 0 END) AS building_tag_340102,
    MAX(CASE WHEN building_tag_id = 340103 THEN 1 ELSE 0 END) AS building_tag_340103,
    MAX(CASE WHEN building_tag_id = 340201 THEN 1 ELSE 0 END) AS building_tag_340201,
    MAX(CASE WHEN building_tag_id = 340401 THEN 1 ELSE 0 END) AS building_tag_340401,
    MAX(CASE WHEN building_tag_id = 340501 THEN 1 ELSE 0 END) AS building_tag_340501,
    MAX(CASE WHEN building_tag_id = 343101 THEN 1 ELSE 0 END) AS building_tag_343101,
    MAX(CASE WHEN building_tag_id = 110101 THEN 1 ELSE 0 END) AS building_tag_110101,
    MAX(CASE WHEN building_tag_id = 110102 THEN 1 ELSE 0 END) AS building_tag_110102,
    MAX(CASE WHEN building_tag_id = 110201 THEN 1 ELSE 0 END) AS building_tag_110201,
    MAX(CASE WHEN building_tag_id = 110202 THEN 1 ELSE 0 END) AS building_tag_110202,
    MAX(CASE WHEN building_tag_id = 110301 THEN 1 ELSE 0 END) AS building_tag_110301,
    MAX(CASE WHEN building_tag_id = 110302 THEN 1 ELSE 0 END) AS building_tag_110302,
    MAX(CASE WHEN building_tag_id = 110401 THEN 1 ELSE 0 END) AS building_tag_110401,
    MAX(CASE WHEN building_tag_id = 110402 THEN 1 ELSE 0 END) AS building_tag_110402,
    MAX(CASE WHEN building_tag_id = 110501 THEN 1 ELSE 0 END) AS building_tag_110501,
    MAX(CASE WHEN building_tag_id = 110502 THEN 1 ELSE 0 END) AS building_tag_110502,
    MAX(CASE WHEN building_tag_id = 110503 THEN 1 ELSE 0 END) AS building_tag_110503,
    MAX(CASE WHEN building_tag_id = 110601 THEN 1 ELSE 0 END) AS building_tag_110601,
    MAX(CASE WHEN building_tag_id = 110602 THEN 1 ELSE 0 END) AS building_tag_110602,
    MAX(CASE WHEN building_tag_id = 110603 THEN 1 ELSE 0 END) AS building_tag_110603,
    MAX(CASE WHEN building_tag_id = 110701 THEN 1 ELSE 0 END) AS building_tag_110701,
    MAX(CASE WHEN building_tag_id = 110702 THEN 1 ELSE 0 END) AS building_tag_110702,
    MAX(CASE WHEN building_tag_id = 110801 THEN 1 ELSE 0 END) AS building_tag_110801,
    MAX(CASE WHEN building_tag_id = 110802 THEN 1 ELSE 0 END) AS building_tag_110802,
    MAX(CASE WHEN building_tag_id = 110901 THEN 1 ELSE 0 END) AS building_tag_110901,
    MAX(CASE WHEN building_tag_id = 110902 THEN 1 ELSE 0 END) AS building_tag_110902,
    MAX(CASE WHEN building_tag_id = 110903 THEN 1 ELSE 0 END) AS building_tag_110903,
    MAX(CASE WHEN building_tag_id = 111001 THEN 1 ELSE 0 END) AS building_tag_111001,
    MAX(CASE WHEN building_tag_id = 111002 THEN 1 ELSE 0 END) AS building_tag_111002,
    MAX(CASE WHEN building_tag_id = 113301 THEN 1 ELSE 0 END) AS building_tag_113301,
    MAX(CASE WHEN building_tag_id = 113302 THEN 1 ELSE 0 END) AS building_tag_113302,
    MAX(CASE WHEN building_tag_id = 113303 THEN 1 ELSE 0 END) AS building_tag_113303,
    MAX(CASE WHEN building_tag_id = 113401 THEN 1 ELSE 0 END) AS building_tag_113401,
    MAX(CASE WHEN building_tag_id = 113402 THEN 1 ELSE 0 END) AS building_tag_113402,
    MAX(CASE WHEN building_tag_id = 113501 THEN 1 ELSE 0 END) AS building_tag_113501,
    MAX(CASE WHEN building_tag_id = 113601 THEN 1 ELSE 0 END) AS building_tag_113601,
    MAX(CASE WHEN building_tag_id = 113701 THEN 1 ELSE 0 END) AS building_tag_113701,
    MAX(CASE WHEN building_tag_id = 120101 THEN 1 ELSE 0 END) AS building_tag_120101,
    MAX(CASE WHEN building_tag_id = 120201 THEN 1 ELSE 0 END) AS building_tag_120201,
    MAX(CASE WHEN building_tag_id = 120301 THEN 1 ELSE 0 END) AS building_tag_120301,
    MAX(CASE WHEN building_tag_id = 120401 THEN 1 ELSE 0 END) AS building_tag_120401,
    MAX(CASE WHEN building_tag_id = 120501 THEN 1 ELSE 0 END) AS building_tag_120501,
    MAX(CASE WHEN building_tag_id = 120601 THEN 1 ELSE 0 END) AS building_tag_120601,
    MAX(CASE WHEN building_tag_id = 120801 THEN 1 ELSE 0 END) AS building_tag_120801,
    MAX(CASE WHEN building_tag_id = 121001 THEN 1 ELSE 0 END) AS building_tag_121001,
    MAX(CASE WHEN building_tag_id = 121002 THEN 1 ELSE 0 END) AS building_tag_121002,
    MAX(CASE WHEN building_tag_id = 121101 THEN 1 ELSE 0 END) AS building_tag_121101,
    MAX(CASE WHEN building_tag_id = 123201 THEN 1 ELSE 0 END) AS building_tag_123201,
    MAX(CASE WHEN building_tag_id = 123301 THEN 1 ELSE 0 END) AS building_tag_123301,
    MAX(CASE WHEN building_tag_id = 123401 THEN 1 ELSE 0 END) AS building_tag_123401,
    MAX(CASE WHEN building_tag_id = 123501 THEN 1 ELSE 0 END) AS building_tag_123501,
    MAX(CASE WHEN building_tag_id = 123601 THEN 1 ELSE 0 END) AS building_tag_123601,
    MAX(CASE WHEN building_tag_id = 190101 THEN 1 ELSE 0 END) AS building_tag_190101,
    MAX(CASE WHEN building_tag_id = 193201 THEN 1 ELSE 0 END) AS building_tag_193201,
    MAX(CASE WHEN building_tag_id = 193301 THEN 1 ELSE 0 END) AS building_tag_193301,
    MAX(CASE WHEN building_tag_id = 193401 THEN 1 ELSE 0 END) AS building_tag_193401,
    MAX(CASE WHEN building_tag_id = 193501 THEN 1 ELSE 0 END) AS building_tag_193501,
    MAX(CASE WHEN building_tag_id = 193601 THEN 1 ELSE 0 END) AS building_tag_193601,
    MAX(CASE WHEN building_tag_id = 320601 THEN 1 ELSE 0 END) AS building_tag_320601,
    MAX(CASE WHEN building_tag_id = 330701 THEN 1 ELSE 0 END) AS building_tag_330701,
    MAX(CASE WHEN building_tag_id = 330801 THEN 1 ELSE 0 END) AS building_tag_330801,
    MAX(CASE WHEN building_tag_id = 330901 THEN 1 ELSE 0 END) AS building_tag_330901,
    MAX(CASE WHEN building_tag_id = 334801 THEN 1 ELSE 0 END) AS building_tag_334801,
    MAX(CASE WHEN building_tag_id = 335001 THEN 1 ELSE 0 END) AS building_tag_335001,
    MAX(CASE WHEN building_tag_id = 335101 THEN 1 ELSE 0 END) AS building_tag_335101,
    MAX(CASE WHEN building_tag_id = 335201 THEN 1 ELSE 0 END) AS building_tag_335201,
    MAX(CASE WHEN building_tag_id = 335301 THEN 1 ELSE 0 END) AS building_tag_335301,
    MAX(CASE WHEN building_tag_id = 335401 THEN 1 ELSE 0 END) AS building_tag_335401,
    MAX(CASE WHEN building_tag_id = 335501 THEN 1 ELSE 0 END) AS building_tag_335501,
    MAX(CASE WHEN building_tag_id = 335601 THEN 1 ELSE 0 END) AS building_tag_335601,
    MAX(CASE WHEN building_tag_id = 335701 THEN 1 ELSE 0 END) AS building_tag_335701,
    MAX(CASE WHEN building_tag_id = 335901 THEN 1 ELSE 0 END) AS building_tag_335901,
    MAX(CASE WHEN building_tag_id = 335902 THEN 1 ELSE 0 END) AS building_tag_335902,
    MAX(CASE WHEN building_tag_id = 336001 THEN 1 ELSE 0 END) AS building_tag_336001,
    MAX(CASE WHEN building_tag_id = 336101 THEN 1 ELSE 0 END) AS building_tag_336101,
    MAX(CASE WHEN building_tag_id = 336201 THEN 1 ELSE 0 END) AS building_tag_336201,
    MAX(CASE WHEN building_tag_id = 336301 THEN 1 ELSE 0 END) AS building_tag_336301,
    MAX(CASE WHEN building_tag_id = 336501 THEN 1 ELSE 0 END) AS building_tag_336501,
    MAX(CASE WHEN building_tag_id = 350101 THEN 1 ELSE 0 END) AS building_tag_350101,
    MAX(CASE WHEN building_tag_id = 350102 THEN 1 ELSE 0 END) AS building_tag_350102,
    MAX(CASE WHEN building_tag_id = 350301 THEN 1 ELSE 0 END) AS building_tag_350301,
    MAX(CASE WHEN building_tag_id = 513601 THEN 1 ELSE 0 END) AS building_tag_513601,
    MAX(CASE WHEN building_tag_id = 513701 THEN 1 ELSE 0 END) AS building_tag_513701,
    MAX(CASE WHEN building_tag_id = 513801 THEN 1 ELSE 0 END) AS building_tag_513801,
    MAX(CASE WHEN building_tag_id = 513901 THEN 1 ELSE 0 END) AS building_tag_513901,
    MAX(CASE WHEN building_tag_id = 513902 THEN 1 ELSE 0 END) AS building_tag_513902,
    MAX(CASE WHEN building_tag_id = 513903 THEN 1 ELSE 0 END) AS building_tag_513903,
    MAX(CASE WHEN building_tag_id = 514001 THEN 1 ELSE 0 END) AS building_tag_514001,
    MAX(CASE WHEN building_tag_id = 514002 THEN 1 ELSE 0 END) AS building_tag_514002,
    MAX(CASE WHEN building_tag_id = 514101 THEN 1 ELSE 0 END) AS building_tag_514101,
    MAX(CASE WHEN building_tag_id = 514102 THEN 1 ELSE 0 END) AS building_tag_514102,
    MAX(CASE WHEN building_tag_id = 514103 THEN 1 ELSE 0 END) AS building_tag_514103,
    MAX(CASE WHEN building_tag_id = 514201 THEN 1 ELSE 0 END) AS building_tag_514201,
    MAX(CASE WHEN building_tag_id = 514301 THEN 1 ELSE 0 END) AS building_tag_514301,
    MAX(CASE WHEN building_tag_id = 514401 THEN 1 ELSE 0 END) AS building_tag_514401,
    MAX(CASE WHEN building_tag_id = 514501 THEN 1 ELSE 0 END) AS building_tag_514501
from
    {{ ref('02_05_dm_building_tag') }}
group by
  id
)
select
    t1.id,
    building_tag_210101,
    building_tag_210102,
    building_tag_210199,
    building_tag_210201,
    building_tag_210202,
    building_tag_210299,
    building_tag_210301,
    building_tag_210302,
    building_tag_210303,
    building_tag_210399,
    building_tag_210401,
    building_tag_213101,
    building_tag_213201,
    building_tag_213301,
    building_tag_294201,
    building_tag_310101,
    building_tag_310201,
    building_tag_310301,
    building_tag_310401,
    building_tag_313101,
    building_tag_320101,
    building_tag_320201,
    building_tag_320301,
    building_tag_320401,
    building_tag_320501,
    building_tag_320701,
    building_tag_320801,
    building_tag_320901,
    building_tag_321001,
    building_tag_321101,
    building_tag_323101,
    building_tag_323201,
    building_tag_330101,
    building_tag_330201,
    building_tag_330301,
    building_tag_330401,
    building_tag_330501,
    building_tag_330601,
    building_tag_333201,
    building_tag_333301,
    building_tag_333401,
    building_tag_333402,
    building_tag_333601,
    building_tag_333801,
    building_tag_334001,
    building_tag_334101,
    building_tag_334201,
    building_tag_334301,
    building_tag_334501,
    building_tag_340301,
    building_tag_343201,
    building_tag_343301,
    building_tag_393101,
    building_tag_393201,
    building_tag_393401,
    building_tag_410101,
    building_tag_410201,
    building_tag_410203,
    building_tag_420101,
    building_tag_423103,
    building_tag_423201,
    building_tag_423301,
    building_tag_423401,
    building_tag_423501,
    building_tag_433201,
    building_tag_433301,
    building_tag_220101,
    building_tag_220102,
    building_tag_220103,
    building_tag_220201,
    building_tag_220202,
    building_tag_220203,
    building_tag_220301,
    building_tag_220401,
    building_tag_220501,
    building_tag_220601,
    building_tag_220701,
    building_tag_220801,
    building_tag_220901,
    building_tag_220902,
    building_tag_223101,
    building_tag_223201,
    building_tag_223301,
    building_tag_223401,
    building_tag_223501,
    building_tag_223601,
    building_tag_230101,
    building_tag_230102,
    building_tag_230103,
    building_tag_230201,
    building_tag_230202,
    building_tag_230203,
    building_tag_230204,
    building_tag_230302,
    building_tag_230401,
    building_tag_230501,
    building_tag_230601,
    building_tag_230701,
    building_tag_230801,
    building_tag_230802,
    building_tag_230901,
    building_tag_233101,
    building_tag_233201,
    building_tag_240101,
    building_tag_240102,
    building_tag_240103,
    building_tag_240104,
    building_tag_240201,
    building_tag_250101,
    building_tag_250201,
    building_tag_250301,
    building_tag_253101,
    building_tag_253201,
    building_tag_253301,
    building_tag_253401,
    building_tag_253501,
    building_tag_253601,
    building_tag_253701,
    building_tag_260101,
    building_tag_260201,
    building_tag_260301,
    building_tag_260401,
    building_tag_260501,
    building_tag_260502,
    building_tag_260503,
    building_tag_260601,
    building_tag_263101,
    building_tag_263201,
    building_tag_263301,
    building_tag_270101,
    building_tag_273101,
    building_tag_283101,
    building_tag_283201,
    building_tag_283301,
    building_tag_283401,
    building_tag_290101,
    building_tag_290201,
    building_tag_290301,
    building_tag_290401,
    building_tag_290501,
    building_tag_290601,
    building_tag_290701,
    building_tag_290801,
    building_tag_290901,
    building_tag_290902,
    building_tag_293101,
    building_tag_293201,
    building_tag_293301,
    building_tag_293401,
    building_tag_293501,
    building_tag_293601,
    building_tag_293701,
    building_tag_293801,
    building_tag_294001,
    building_tag_294101,
    building_tag_294301,
    building_tag_310501,
    building_tag_313301,
    building_tag_331001,
    building_tag_334401,
    building_tag_340101,
    building_tag_340102,
    building_tag_340103,
    building_tag_340201,
    building_tag_340401,
    building_tag_340501,
    building_tag_343101,
    building_tag_110101,
    building_tag_110102,
    building_tag_110201,
    building_tag_110202,
    building_tag_110301,
    building_tag_110302,
    building_tag_110401,
    building_tag_110402,
    building_tag_110501,
    building_tag_110502,
    building_tag_110503,
    building_tag_110601,
    building_tag_110602,
    building_tag_110603,
    building_tag_110701,
    building_tag_110702,
    building_tag_110801,
    building_tag_110802,
    building_tag_110901,
    building_tag_110902,
    building_tag_110903,
    building_tag_111001,
    building_tag_111002,
    building_tag_113301,
    building_tag_113302,
    building_tag_113303,
    building_tag_113401,
    building_tag_113402,
    building_tag_113501,
    building_tag_113601,
    building_tag_113701,
    building_tag_120101,
    building_tag_120201,
    building_tag_120301,
    building_tag_120401,
    building_tag_120501,
    building_tag_120601,
    building_tag_120801,
    building_tag_121001,
    building_tag_121002,
    building_tag_121101,
    building_tag_123201,
    building_tag_123301,
    building_tag_123401,
    building_tag_123501,
    building_tag_123601,
    building_tag_190101,
    building_tag_193201,
    building_tag_193301,
    building_tag_193401,
    building_tag_193501,
    building_tag_193601,
    building_tag_320601,
    building_tag_330701,
    building_tag_330801,
    building_tag_330901,
    building_tag_334801,
    building_tag_335001,
    building_tag_335101,
    building_tag_335201,
    building_tag_335301,
    building_tag_335401,
    building_tag_335501,
    building_tag_335601,
    building_tag_335701,
    building_tag_335901,
    building_tag_335902,
    building_tag_336001,
    building_tag_336101,
    building_tag_336201,
    building_tag_336301,
    building_tag_336501,
    building_tag_350101,
    building_tag_350102,
    building_tag_350301,
    building_tag_513601,
    building_tag_513701,
    building_tag_513801,
    building_tag_513901,
    building_tag_513902,
    building_tag_513903,
    building_tag_514001,
    building_tag_514002,
    building_tag_514101,
    building_tag_514102,
    building_tag_514103,
    building_tag_514201,
    building_tag_514301,
    building_tag_514401,
    building_tag_514501
from
    {{ ref(table_name) }} as t1
    left join
    temp1 as t2
    on
        t1.id = t2.id
